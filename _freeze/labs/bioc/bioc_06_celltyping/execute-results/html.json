{
  "hash": "54e07c060432a690ce74140870dbd2ab",
  "result": {
    "markdown": "---\ntitle: \"{{< meta ct_title >}}\"\nsubtitle: \"{{< meta subtitle_bioc >}}\"\ndescription: \"{{< meta ct_description >}}\"\nformat: html\n---\n\n\n::: {.callout-note}\nCode chunks run R commands unless otherwise specified.\n:::\n\n\n{{< meta ct_1 >}}\n\n\n{{< meta ct_2 >}}\n\n\n\n## {{< meta ct_read >}}\n\n\n{{< meta ct_read_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages({\n  library(scater)\n  library(scran)\n  library(dplyr)\n  library(cowplot)\n  library(ggplot2)\n  library(pheatmap)\n  library(rafalib)\n  library(scPred)\n  library(scmap)\n})\n```\n:::\n\n{{< meta ct_read_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#load the data and select 'ctrl_13` sample\nalldata <- readRDS(\"data/results/covid_qc_dr_int_cl.rds\")\n```\n:::\n\n{{< meta ct_read_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl.sce <- alldata[, alldata@colData$sample == 'ctrl.13']\n\n# remove all old dimensionality reductions as they will mess up the analysis further down\nreducedDims(ctrl.sce) <- NULL\n```\n:::\n\n\n## {{< meta ct_ref >}}\n\n\n{{< meta ct_ref_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreference <- scPred::pbmc_1\nreference\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n32838 features across 3500 samples within 1 assay \nActive assay: RNA (32838 features, 0 variable features)\n```\n:::\n:::\n\n\nConvert to a SCE object.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nref.sce = Seurat::as.SingleCellExperiment(reference)\n```\n:::\n\n{{< meta ct_ref_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Normalize\nref.sce <- computeSumFactors(ref.sce)\nref.sce <- logNormCounts(ref.sce)\n\n#Variable genes\nvar.out <- modelGeneVar(ref.sce, method=\"loess\")\nhvg.ref <- getTopHVGs(var.out, n=1000)  \n\n# Dim reduction\nref.sce <- runPCA(ref.sce, exprs_values = \"logcounts\",  scale = T,\n              ncomponents = 30, subset_row = hvg.ref)\nref.sce <- runUMAP(ref.sce, dimred = \"PCA\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotReducedDim(ref.sce,dimred = \"UMAP\",colour_by = \"cell_type\")\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n{{< meta ct_ref_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Normalize\nctrl.sce <- computeSumFactors(ctrl.sce)\nctrl.sce <- logNormCounts(ctrl.sce)\n\n#Variable genes\nvar.out <- modelGeneVar(ctrl.sce, method=\"loess\")\nhvg.ctrl <- getTopHVGs(var.out, n=1000)  \n\n# Dim reduction\nctrl.sce <- runPCA(ctrl.sce, exprs_values = \"logcounts\",  scale = T, ncomponents = 30, subset_row = hvg.ctrl)\nctrl.sce <- runUMAP(ctrl.sce, dimred = \"PCA\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotReducedDim(ctrl.sce,dimred = \"UMAP\",colour_by = \"louvain_SNNk15\")\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\n## scMap\n\nThe scMap package is one method for projecting cells from a scRNA-seq experiment on to the cell-types or individual cells identified in a different experiment. It can be run on different levels, either projecting by cluster or by single cell, here we will try out both.\n\nFor scmap cell type labels must be stored in the `cell_type1` column of the `colData` slots, and gene ids that are consistent across both datasets must be stored in the `feature_symbol` column of the `rowData` slots.\n\n### scMap cluster\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add in slot cell_type1\nref.sce@colData$cell_type1 = ref.sce@colData$cell_type\n# create a rowData slot with feature_symbol\nrd = data.frame(feature_symbol=rownames(ref.sce))\nrownames(rd) = rownames(ref.sce)\nrowData(ref.sce) = rd\n\n# same for the ctrl dataset\n# create a rowData slot with feature_symbol\nrd = data.frame(feature_symbol=rownames(ctrl.sce))\nrownames(rd) = rownames(ctrl.sce)\nrowData(ctrl.sce) = rd\n```\n:::\n\n\nThen we can select variable features in both datasets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# select features\ncounts(ctrl.sce) <- as.matrix(counts(ctrl.sce))\nlogcounts(ctrl.sce) <- as.matrix(logcounts(ctrl.sce))\nctrl.sce <- selectFeatures(ctrl.sce, suppress_plot = TRUE)\n\ncounts(ref.sce) <- as.matrix(counts(ref.sce))\nlogcounts(ref.sce) <- as.matrix(logcounts(ref.sce))\nref.sce <- selectFeatures(ref.sce, suppress_plot = TRUE)\n```\n:::\n\n\nThen we need to index the reference dataset by cluster, default is the clusters in `cell_type1`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nref.sce <- indexCluster(ref.sce)\n```\n:::\n\n\nNow we project the Covid-19 dataset onto that index.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproject_cluster <- scmapCluster(\n  projection = ctrl.sce,\n  index_list = list(\n    ref = metadata(ref.sce)$scmap_cluster_index\n  )\n)\n\n# projected labels\ntable(project_cluster$scmap_cluster_labs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     B cell  CD4 T cell  CD8 T cell         cDC       cMono      ncMono \n         66         108         133          38         217         144 \n    NK cell         pDC Plasma cell  unassigned \n        256           2           3         208 \n```\n:::\n:::\n\n\nThen add the predictions to metadata and plot UMAP.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add in predictions\nctrl.sce@colData$scmap_cluster <- project_cluster$scmap_cluster_labs\n\nplotReducedDim(ctrl.sce,dimred = \"UMAP\",colour_by = \"scmap_cluster\")\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-14-1.png){width=576}\n:::\n:::\n\n\n## scMap cell\n\nWe can instead index the refernce data based on each single cell and project our data onto the closest neighbor in that dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nref.sce <- indexCell(ref.sce)\n```\n:::\n\n\nAgain we need to index the reference dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproject_cell <- scmapCell(\n  projection = ctrl.sce,\n  index_list = list(\n    ref = metadata(ref.sce)$scmap_cell_index\n  )\n)\n```\n:::\n\n\nWe now get a table with index for the 5 nearest neigbors in the reference dataset for each cell in our dataset. We will select the celltype of the closest neighbor and assign it to the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncell_type_pred <- colData(ref.sce)$cell_type1[project_cell$ref[[1]][1,]]\ntable(cell_type_pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncell_type_pred\n     B cell  CD4 T cell  CD8 T cell         cDC       cMono      ncMono \n        101         192         266          22         213         189 \n    NK cell         pDC Plasma cell \n        188           2           2 \n```\n:::\n:::\n\n\nThen add the predictions to metadata and plot umap.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add in predictions\nctrl.sce@colData$scmap_cell <- cell_type_pred\n\nplotReducedDim(ctrl.sce,dimred = \"UMAP\",colour_by = \"scmap_cell\")\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-18-1.png){width=576}\n:::\n:::\n\n\nPlot both:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncowplot::plot_grid( ncol = 2,\nplotReducedDim(ctrl.sce,dimred = \"UMAP\",colour_by = \"scmap_cluster\"),\nplotReducedDim(ctrl.sce,dimred = \"UMAP\",colour_by = \"scmap_cell\")\n)\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n## {{< meta ct_scpred >}}\n\n\n{{< meta ct_scpred_1 >}}\n\n\n\nscPred works with Seurat objects, so we will convert both objects to seurat objects. You may see a lot of warnings about renaming things, but as long as you do not see an Error, you should be fine.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(Seurat))\n\nreference <- Seurat::as.Seurat(ref.sce)\nctrl <- Seurat::as.Seurat(ctrl.sce)\n```\n:::\n\n\nThe loadings matrix is lost when converted to Seurat object, and scPred needs that information. So we need to rerun PCA with Seurat and the same hvgs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVariableFeatures(reference) = hvg.ref\nreference <- reference %>% ScaleData(verbose=F) %>% RunPCA(verbose=F)\n\nVariableFeatures(ctrl) = hvg.ctrl\nctrl <- ctrl %>% ScaleData(verbose=F) %>% RunPCA(verbose=F)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreference <- getFeatureSpace(reference, \"cell_type\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Extracting feature space for each cell type...\nDONE!\n```\n:::\n\n```{.r .cell-code}\nreference <- trainModel(reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Training models for each cell type...\nDONE!\n```\n:::\n:::\n\n{{< meta ct_scpred_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_scpred(reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'scPred' object\n✔  Prediction variable = cell_type \n✔  Discriminant features per cell type\n✔  Training model(s)\nSummary\n\n|Cell type   |    n| Features|Method    |   ROC|  Sens|  Spec|\n|:-----------|----:|--------:|:---------|-----:|-----:|-----:|\n|B cell      |  280|       50|svmRadial | 1.000| 1.000| 1.000|\n|CD4 T cell  | 1620|       50|svmRadial | 0.994| 0.972| 0.963|\n|CD8 T cell  |  945|       50|svmRadial | 0.973| 0.859| 0.971|\n|cDC         |   26|       50|svmRadial | 0.994| 0.727| 0.999|\n|cMono       |  212|       50|svmRadial | 1.000| 0.957| 0.997|\n|ncMono      |   79|       50|svmRadial | 1.000| 0.962| 0.999|\n|NK cell     |  312|       50|svmRadial | 0.998| 0.926| 0.995|\n|pDC         |   20|       50|svmRadial | 1.000| 0.950| 1.000|\n|Plasma cell |    6|       50|svmRadial | 1.000| 1.000| 1.000|\n```\n:::\n:::\n\n{{< meta ct_scpred_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl <- scPredict(ctrl, reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Matching reference with new dataset...\n\t ─ 1000 features present in reference loadings\n\t ─ 937 features shared between reference and new dataset\n\t ─ 93.7% of features in the reference are present in new dataset\n●  Aligning new data to reference...\n●  Classifying cells...\nDONE!\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(ctrl, group.by = \"scpred_prediction\", label = T, repel = T) + NoAxes()\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n{{< meta ct_scpred_4 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ctrl@meta.data, aes(x=louvain_SNNk15, fill = scpred_prediction)) + geom_bar() + theme_classic()\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nAdd the predictions into the SCE object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl.sce@colData$scpred_prediction = ctrl$scpred_prediction\n```\n:::\n\n\n## {{< meta ct_compare >}}\n\n\n{{< meta ct_compare_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrossTab(ctrl, \"scmap_cell\", \"scpred_prediction\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"B cell\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"CD4 T cell\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"CD8 T cell\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cDC\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cMono\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"ncMono\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"NK cell\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"pDC\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Plasma cell\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"99\",\"2\":\"3\",\"3\":\"1\",\"4\":\"0\",\"5\":\"2\",\"6\":\"1\",\"7\":\"1\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"B cell\"},{\"1\":\"1\",\"2\":\"114\",\"3\":\"28\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"CD4 T cell\"},{\"1\":\"0\",\"2\":\"46\",\"3\":\"194\",\"4\":\"0\",\"5\":\"2\",\"6\":\"0\",\"7\":\"120\",\"8\":\"0\",\"9\":\"1\",\"_rn_\":\"CD8 T cell\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"7\",\"5\":\"2\",\"6\":\"2\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"cDC\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"14\",\"5\":\"167\",\"6\":\"75\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"cMono\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"12\",\"6\":\"88\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"ncMono\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"22\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"61\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"NK cell\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"pDC\"},{\"1\":\"0\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"_rn_\":\"Plasma cell\"},{\"1\":\"1\",\"2\":\"28\",\"3\":\"20\",\"4\":\"1\",\"5\":\"27\",\"6\":\"23\",\"7\":\"6\",\"8\":\"2\",\"9\":\"1\",\"_rn_\":\"unassigned\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## {{< meta ct_gsea >}}\n\n\n{{< meta ct_gsea_1 >}}\n\n\n\n### {{< meta ct_gsea_deg >}}\n\n\n{{< meta ct_gsea_deg_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run differential expression in our dataset, using clustering at resolution 0.3\nDGE_list <- scran::findMarkers(\n  x = alldata,\n  groups = as.character(alldata@colData$louvain_SNNk15),\n  pval.type = \"all\",\n  min.prop = 0\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute differential gene expression in reference dataset (that has cell annotation)\nref_DGE <- scran::findMarkers(\n  x = ref.sce,\n  groups = as.character(ref.sce@colData$cell_type),\n  pval.type = \"all\",\n  direction = \"up\"\n)\n\n# Identify the top cell marker genes in reference dataset\n# select top 50 with hihgest foldchange among top 100 signifcant genes.\nref_list <- lapply(ref_DGE, function(x){\n  x$logFC <- rowSums( as.matrix( x[,grep(\"logFC\",colnames(x))] ))\n  x %>% as.data.frame() %>% filter(p.value < 0.01) %>% top_n(-100, p.value) %>% top_n(50, logFC) %>% rownames()\n  }\n)\n\nunlist(lapply(ref_list, length))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     B cell  CD4 T cell  CD8 T cell         cDC       cMono      ncMono \n         50          50          19          17          50          50 \n    NK cell         pDC Plasma cell \n         50          50          24 \n```\n:::\n:::\n\n{{< meta ct_gsea_deg_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(fgsea))\n\n# run fgsea for each of the clusters in the list\nres <- lapply(DGE_list, function(x){\n  x$logFC <- rowSums( as.matrix( x[,grep(\"logFC\",colnames(x))] ))\n  gene_rank <- setNames(x$logFC, rownames(x))\n  fgseaRes <- fgsea( pathways=ref_list, stats=gene_rank,nperm=10000)\n  return(fgseaRes)\n})\nnames(res) <- names(DGE_list)\n\n# You can filter and resort the table based on ES, NES or pvalue\nres <- lapply(res, function(x) {x[ x$pval < 0.1 , ]} )\nres <- lapply(res, function(x) {x[ x$size > 2 , ]} )\nres <- lapply(res, function(x) {x[order(x$NES,decreasing = T), ]} )\nres\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`1`\n      pathway         pval         padj         ES       NES nMoreExtreme size\n1:     B cell 0.0001927897 0.0004709083  0.9654400  1.996271            0   47\n2: CD4 T cell 0.0001913143 0.0004709083  0.8611463  1.797727            0   50\n3:        cDC 0.0004054328 0.0007297790  0.9567266  1.693487            1   17\n4: CD8 T cell 0.0011836654 0.0015218555 -0.9039497 -1.625338            5   17\n5:      cMono 0.0008307373 0.0012461059 -0.7922962 -1.683510            3   47\n6:     ncMono 0.0002092926 0.0004709083 -0.8909656 -1.902068            0   49\n7:    NK cell 0.0002092926 0.0004709083 -0.9173376 -1.958368            0   49\n                                               leadingEdge\n1:          CD37,MS4A1,TNFRSF13C,CXCR4,LINC00926,BANK1,...\n2:                   RPS29,RPS6,RPL13,RPL32,RPL3,RPL21,...\n3: HLA-DRA,HLA-DQB1,HLA-DPB1,HLA-DRB1,HLA-DPA1,HLA-DMA,...\n4:                        CCL5,IL32,GZMH,CD3D,CD2,LYAR,...\n5:                S100A6,S100A9,LYZ,S100A8,TYROBP,FCN1,...\n6:               S100A4,FCER1G,S100A11,AIF1,TIMP1,PSAP,...\n7:                     NKG7,HCST,ITGB2,GNLY,MYO1F,CST7,...\n\n$`2`\n       pathway         pval         padj         ES       NES nMoreExtreme size\n1:       cMono 0.0001488538 0.0005616225  0.9506666  1.883687            0   47\n2:      ncMono 0.0004424779 0.0006637168  0.8730863  1.739447            2   49\n3: Plasma cell 0.0247007894 0.0317581578 -0.7585071 -1.513369           96   24\n4:  CD8 T cell 0.0002416043 0.0005616225 -0.9090058 -1.702997            0   17\n5:     NK cell 0.0003103662 0.0005616225 -0.7923197 -1.802458            0   49\n6:      B cell 0.0003045067 0.0005616225 -0.8792018 -1.988035            0   47\n7:  CD4 T cell 0.0003120125 0.0005616225 -0.9273714 -2.115810            0   50\n                                leadingEdge\n1:  S100A8,S100A9,LYZ,S100A12,VCAN,FCN1,...\n2: S100A11,AIF1,S100A4,SAT1,FCER1G,MAFB,...\n3:    PEBP1,ISG20,FKBP11,MIF,CYCS,SPCS2,...\n4:         CCL5,IL32,GZMH,CD3D,CD2,LYAR,...\n5:       GNLY,NKG7,GZMA,CTSW,B2M,FGFBP2,...\n6: RPS5,RPL23A,CXCR4,RPL13A,RPL18A,CD52,...\n7:  RPL3,RPS4X,RPL5,EEF1A1,RPS27A,RPL14,...\n\n$`3`\n      pathway         pval         padj         ES       NES nMoreExtreme size\n1: CD4 T cell 0.0001886081 0.0006382979  0.9809186  2.085454            0   50\n2:     B cell 0.0362153963 0.0465626524  0.6874085  1.446835          190   47\n3:    NK cell 0.0029787234 0.0044680851 -0.7551115 -1.632298           13   49\n4:        cDC 0.0010066438 0.0018119589 -0.9165423 -1.669600            4   17\n5:        pDC 0.0008460237 0.0018119589 -0.8104411 -1.741714            3   47\n6:      cMono 0.0002115059 0.0006382979 -0.9118854 -1.959727            0   47\n7:     ncMono 0.0002127660 0.0006382979 -0.9404478 -2.032933            0   49\n                                                leadingEdge\n1:                    IL7R,LDHB,PIK3IP1,RPL3,RPS12,RPS6,...\n2:                RPS5,RPL13A,RPL23A,RPL18A,RPS23,RPL12,...\n3:                     NKG7,GNLY,CST7,GZMA,MYO1F,FGFBP2,...\n4: HLA-DRA,HLA-DRB1,HLA-DPA1,HLA-DPB1,HLA-DQB1,HLA-DRB5,...\n5:                      PLEK,NPC2,PTPRE,PLAC8,CTSB,IRF8,...\n6:                S100A9,S100A8,LYZ,TYROBP,FCN1,S100A12,...\n7:                    FCER1G,PSAP,AIF1,IFITM3,LST1,FTH1,...\n\n$`4`\n      pathway         pval         padj         ES       NES nMoreExtreme size\n1:     ncMono 0.0012733447 0.0022920204 -0.7748661 -1.424156           11   49\n2:     B cell 0.0009587728 0.0021572387 -0.7796204 -1.426295            8   47\n3:    NK cell 0.0008488964 0.0021572387 -0.7813979 -1.436161            7   49\n4:        cDC 0.0040390441 0.0060585661 -0.8695803 -1.450825           35   17\n5:      cMono 0.0001065303 0.0004793864 -0.8311165 -1.520506            0   47\n6: CD4 T cell 0.0001059322 0.0004793864 -0.9078329 -1.671131            0   50\n                                               leadingEdge\n1:               S100A4,S100A11,CEBPB,AIF1,IFITM2,SAT1,...\n2:                   RPS23,RPS11,CD52,RPL13A,FAU,RPL12,...\n3:                   ITGB2,NKG7,MYO1F,GNLY,IFITM1,HCST,...\n4: HLA-DRA,HLA-DRB1,HLA-DPB1,HLA-DPA1,HLA-DQB1,HLA-DMA,...\n5:                  JUND,S100A6,TYROBP,NFKBIA,LYZ,FCN1,...\n6:                RPL34,RPS29,RPL30,RPS14,EEF1A1,RPL36,...\n\n$`5`\n       pathway         pval        padj         ES       NES nMoreExtreme size\n1:      ncMono 0.0001183992 0.001065593  0.9741230  1.858844            0   49\n2:         cDC 0.0012654668 0.002847300  0.9222958  1.570016            8   17\n3:       cMono 0.0058542413 0.007526882  0.7928335  1.505493           48   47\n4: Plasma cell 0.0105050505 0.011818182 -0.7416214 -1.630275           25   24\n5:     NK cell 0.0019280206 0.003470437 -0.6633798 -1.693144            2   49\n6:      B cell 0.0030637255 0.004595588 -0.6718164 -1.698590            4   47\n7:  CD8 T cell 0.0003460208 0.001557093 -0.9177352 -1.878823            0   17\n8:  CD4 T cell 0.0006455778 0.001936733 -0.8405692 -2.153844            0   50\n                                               leadingEdge\n1:              LST1,AIF1,COTL1,FCER1G,FCGR3A,SERPINA1,...\n2: HLA-DPA1,HLA-DRA,HLA-DPB1,HLA-DRB1,HLA-DRB5,HLA-DMA,...\n3:                   TYROBP,LYZ,S100A6,FCN1,TKT,S100A9,...\n4:                  ISG20,PEBP1,FKBP11,CYCS,JCHAIN,MIF,...\n5:                   CST7,IFITM1,GZMM,FGFBP2,CTSW,PRF1,...\n6:           CXCR4,RPL13A,RPL23A,MS4A1,TNFRSF13C,BANK1,...\n7:                        CCL5,IL32,CD3D,GZMH,CD2,CD8A,...\n8:                  RPS3,RPL31,IL7R,LDHB,MGAT4A,RPS27A,...\n\n$`6`\n       pathway         pval         padj         ES       NES nMoreExtreme size\n1:     NK cell 0.0001600000 0.0004797441  0.9195441  1.907252            0   49\n2:  CD4 T cell 0.0001598210 0.0004797441  0.9046969  1.881553            0   50\n3:  CD8 T cell 0.0001743071 0.0004797441  0.9658685  1.697378            0   17\n4: Plasma cell 0.0518931711 0.0667197914  0.7634732  1.420681          306   24\n5:         cDC 0.0304806565 0.0457209848 -0.8134075 -1.511360          129   17\n6:      ncMono 0.0002665245 0.0004797441 -0.8961485 -2.002228            0   49\n7:       cMono 0.0002642008 0.0004797441 -0.9201712 -2.042908            0   47\n                                            leadingEdge\n1:                    NKG7,GNLY,CST7,GZMA,CTSW,GZMM,...\n2:                  IL7R,RPS29,RPS3,RPL3,RPS6,RPL13,...\n3:                    CCL5,IL32,GZMH,CD3D,LYAR,CD8A,...\n4:             RPL36AL,FKBP11,PPIB,PEBP1,ISG20,CYCS,...\n5: HLA-DRA,HLA-DRB5,HLA-DMA,BASP1,HLA-DQB1,HLA-DRB1,...\n6:                 FCER1G,AIF1,LST1,FTH1,COTL1,PSAP,...\n7:            S100A9,S100A8,LYZ,TYROBP,FCN1,S100A12,...\n\n$`7`\n      pathway         pval         padj         ES       NES nMoreExtreme size\n1:      cMono 0.0001076890 0.0004846005  0.9372421  1.664286            0   47\n2:     ncMono 0.0001073077 0.0004846005  0.9250568  1.648509            0   49\n3:        cDC 0.0078417179 0.0100822088  0.8859262  1.443820           64   17\n4:        pDC 0.0844281714 0.0949816929  0.7118244  1.264006          783   47\n5: CD4 T cell 0.0073855244 0.0100822088 -0.6240606 -1.610574            4   50\n6:     B cell 0.0013966480 0.0026354319 -0.7369408 -1.874564            0   47\n7: CD8 T cell 0.0005837712 0.0017513135 -0.9412358 -1.937687            0   17\n8:    NK cell 0.0014641288 0.0026354319 -0.8162374 -2.091285            0   49\n                                               leadingEdge\n1:                LYZ,S100A9,S100A8,FCN1,TYROBP,S100A6,...\n2:                 AIF1,PSAP,S100A11,FCER1G,COTL1,LST1,...\n3: HLA-DRA,HLA-DRB1,HLA-DPA1,HLA-DQB1,HLA-DPB1,HLA-DMA,...\n4:                       NPC2,CTSB,PLEK,PTPRE,CD4,IRF8,...\n5:                   IL7R,PIK3IP1,RPS3,RPL3,RPS29,TCF7,...\n6:               CXCR4,RPS5,CD79B,MS4A1,TNFRSF13C,CD52,...\n7:                        CCL5,IL32,GZMH,CD3D,CD2,CD8A,...\n8:                     NKG7,GNLY,CST7,GZMA,CTSW,FGFBP2,...\n\n$`8`\n      pathway         pval         padj         ES       NES nMoreExtreme size\n1:    NK cell 0.0002020610 0.0006061831  0.9782014  2.105539            0   49\n2: CD8 T cell 0.0129659643 0.0166705256  0.8704934  1.575693           63   17\n3: CD4 T cell 0.0061252717 0.0091879075 -0.7321603 -1.585427           30   50\n4:        cDC 0.0017765495 0.0031977892 -0.8986806 -1.636249            8   17\n5:     ncMono 0.0003958045 0.0008905601 -0.8203990 -1.769846            1   49\n6:     B cell 0.0001978239 0.0006061831 -0.8415950 -1.804030            0   47\n7:      cMono 0.0001978239 0.0006061831 -0.8948426 -1.918170            0   47\n                                               leadingEdge\n1:                     GNLY,NKG7,PRF1,FGFBP2,CST7,CTSW,...\n2:                   CCL5,GZMH,IL32,LYAR,LINC01871,CD2,...\n3:                 TMEM123,IL7R,RPS13,RPL22,TPT1,RPS28,...\n4: HLA-DRA,HLA-DRB1,HLA-DQB1,HLA-DPA1,HLA-DRB5,HLA-DMA,...\n5:                  COTL1,FTH1,AIF1,LST1,SAT1,SERPINA1,...\n6:                   CD37,RPS11,RPS23,CD52,MS4A1,CD79B,...\n7:                  S100A9,S100A8,LYZ,FCN1,TKT,S100A12,...\n```\n:::\n:::\n\n{{< meta ct_gsea_deg_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew.cluster.ids <- unlist(lapply(res,function(x){as.data.frame(x)[1,1]}))\n\nalldata@colData$ref_gsea <- new.cluster.ids[as.character(alldata@colData$louvain_SNNk15)]\n\ncowplot::plot_grid( ncol = 2,\n   plotReducedDim(alldata, dimred = \"UMAP\",colour_by = \"louvain_SNNk15\"),\n   plotReducedDim(alldata, dimred = \"UMAP\",colour_by = \"ref_gsea\")\n)\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-32-1.png){width=960}\n:::\n:::\n\n{{< meta ct_gsea_deg_4 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl.sce@colData$ref_gsea = alldata@colData$ref_gsea[alldata@colData$sample == \"ctrl.13\"]\n\ncowplot::plot_grid( ncol = 3,\n  plotReducedDim(ctrl.sce, dimred = \"UMAP\",colour_by = \"ref_gsea\"),\n  plotReducedDim(ctrl.sce, dimred = \"UMAP\",colour_by = \"scmap_cell\"),          \n  plotReducedDim(ctrl.sce, dimred = \"UMAP\",colour_by = \"scpred_prediction\")\n)\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-33-1.png){width=1344}\n:::\n:::\n\n\n### {{< meta ct_gsea_annot >}}\n\n\n{{< meta ct_gsea_annot_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the human marker table\nmarkers <- read.delim(\"data/cellmarker/Human_cell_markers.txt\")\nmarkers <- markers [ markers$speciesType == \"Human\", ]\nmarkers <- markers [ markers$cancerType == \"Normal\", ]\n\n#Filter by tissue (to reduce computational time and have tissue-specific classification)\n# sort(unique(markers$tissueType))\n# grep(\"blood\",unique(markers$tissueType),value = T)\n# markers <- markers [ markers$tissueType %in% c(\"Blood\",\"Venous blood\",\n#                                                \"Serum\",\"Plasma\",\n#                                                \"Spleen\",\"Bone marrow\",\"Lymph node\"), ]\n\n\n# remove strange characters etc.\ncelltype_list <- lapply( unique(markers$cellName) , function(x){\n  x <- paste(markers$geneSymbol[markers$cellName == x],sep=\",\")\n  x <- gsub(\"[[]|[]]| |-\",\",\",x)\n  x <- unlist(strsplit( x , split = \",\"))\n  x <- unique(x [ ! x %in% c(\"\",\"NA\",\"family\") ])\n  x <- casefold(x,upper = T)\n})\nnames(celltype_list) <- unique(markers$cellName)\n# celltype_list <- lapply(celltype_list , function(x) {x[1:min(length(x),50)]} )\ncelltype_list <- celltype_list[ unlist(lapply(celltype_list,length)) < 100 ]\ncelltype_list <- celltype_list[ unlist(lapply(celltype_list,length)) > 5 ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# run fgsea for each of the clusters in the list\nres <- lapply(DGE_list, function(x) {\n  x$logFC <- rowSums(as.matrix(x[, grep(\"logFC\", colnames(x))]))\n  gene_rank <- setNames(x$logFC, rownames(x))\n  fgseaRes <- fgsea(pathways = celltype_list, stats = gene_rank, nperm = 10000)\n  return(fgseaRes)\n})\nnames(res) <- names(DGE_list)\n\n# You can filter and resort the table based on ES, NES or pvalue\nres <- lapply(res, function(x) {x[ x$pval < 0.01 , ]} )\nres <- lapply(res, function(x) {x[ x$size > 5 , ]} )\nres <- lapply(res, function(x) {x[order(x$NES,decreasing = T), ]} )\n\n# show top 3 for each cluster.\nlapply(res,head,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`1`\n                       pathway        pval       padj         ES       NES\n1:           Follicular B cell 0.008166440 0.07598316  0.8576833  1.579356\n2:              Pyramidal cell 0.004578025 0.05737792 -0.9698602 -1.492998\n3: CD4+CD25+ regulatory T cell 0.001990446 0.03401853 -0.9787623 -1.506702\n   nMoreExtreme size                         leadingEdge\n1:           41   22 MS4A1,CD69,CD22,FCER2,CD40,PAX5,...\n2:           22    6                           CD3E,NRGN\n3:            9    6            CD3E,CD3D,CD3G,PTPRC,CD4\n\n$`2`\n                  pathway         pval       padj        ES      NES\n1:             Neutrophil 0.0001360359 0.01373265 0.9184505 1.936824\n2: CD1C+_B dendritic cell 0.0001460920 0.01373265 0.9323468 1.864847\n3:           Stromal cell 0.0039203860 0.08544969 0.8450690 1.623956\n   nMoreExtreme size                                  leadingEdge\n1:            0   80 S100A8,S100A9,S100A12,MNDA,NAMPT,S100A11,...\n2:            0   53      S100A8,S100A9,LYZ,S100A12,VCAN,FCN1,...\n3:           25   38          VIM,TIMP2,BST1,TIMP1,ANPEP,CD44,...\n\n$`3`\n             pathway         pval        padj        ES      NES nMoreExtreme\n1: Naive CD8+ T cell 0.0001857010 0.005096508 0.8631756 1.994474            0\n2: Naive CD4+ T cell 0.0001926411 0.005096508 0.9346574 1.861827            0\n3:       CD4+ T cell 0.0001932367 0.005096508 0.9241719 1.761954            0\n   size                           leadingEdge\n1:   91 LDHB,PIK3IP1,TCF7,NPM1,NOSIP,RPS8,...\n2:   34   IL7R,RPS5,EEF1B2,TCF7,NOSIP,MAL,...\n3:   25       IL7R,LTB,CD3E,CD3D,CD3G,CD2,...\n\n$`4`\n                             pathway        pval      padj         ES       NES\n1:                     Megakaryocyte 0.005434783 0.0984022  0.7665186  1.710242\n2: Effector CD8+ memory T (Tem) cell 0.009724809 0.1142665 -0.6875657 -1.309668\n3:                        Neutrophil 0.004751575 0.0984022 -0.6971934 -1.329514\n   nMoreExtreme size                                leadingEdge\n1:            4   26        PF4,PPBP,GP9,ITGA2B,CD9,RASGRP2,...\n2:           93   79    AHNAK,ZEB2,EFHD2,LGALS1,ARL4C,MYO1F,...\n3:           45   80 ITGB2,PTPRC,S100A11,CD44,IFITM2,S100A9,...\n\n$`5`\n            pathway         pval       padj        ES      NES nMoreExtreme\n1: Mesenchymal cell 0.0001149293 0.02160671 0.8525202 1.655527            0\n2:     Stromal cell 0.0014890185 0.06998387 0.8594653 1.595253           11\n3:       Neutrophil 0.0008843688 0.05542044 0.7777406 1.541984            7\n   size                               leadingEdge\n1:   59       COTL1,S100A4,CTSC,VIM,ZEB2,HES4,...\n2:   38     PECAM1,VIM,TIMP1,CD44,ICAM3,PTPRC,...\n3:   80 LST1,FCGR3A,S100A11,CD68,PECAM1,ITGB2,...\n\n$`6`\n                 pathway         pval      padj        ES      NES nMoreExtreme\n1: CD4+ cytotoxic T cell 0.0001527417 0.0106395 0.8725797 1.948876            0\n2:   Natural killer cell 0.0001530925 0.0106395 0.7808456 1.739837            0\n3:           CD8+ T cell 0.0003395586 0.0106395 0.9518468 1.712349            1\n   size                       leadingEdge\n1:   86 CCL5,NKG7,GZMH,GNLY,CST7,GZMA,...\n2:   84 NKG7,CD3D,GNLY,CD3E,GZMA,CD3G,...\n3:   19 NKG7,CD3D,CD3E,CD3G,CD8A,GZMK,...\n\n$`7`\n                  pathway         pval       padj        ES      NES\n1:             Neutrophil 0.0001028807 0.01000639 0.8778882 1.604758\n2: CD1C+_B dendritic cell 0.0001064509 0.01000639 0.8898762 1.593123\n3:           Stromal cell 0.0004386927 0.02749141 0.8623636 1.511856\n   nMoreExtreme size                                 leadingEdge\n1:            0   80 S100A9,S100A8,S100A11,LST1,CD14,S100A12,...\n2:            0   53        LYZ,S100A9,S100A8,FCN1,VCAN,CD14,...\n3:            3   38         VIM,CD44,TIMP2,TIMP1,ICAM1,BST1,...\n\n$`8`\n                             pathway         pval        padj        ES\n1:             CD4+ cytotoxic T cell 0.0002023882 0.007654723 0.9422147\n2: Effector CD8+ memory T (Tem) cell 0.0002027164 0.007654723 0.8946984\n3:               Natural killer cell 0.0002035831 0.007654723 0.8465522\n        NES nMoreExtreme size                           leadingEdge\n1: 2.165615            0   86   GNLY,NKG7,GZMB,PRF1,FGFBP2,CCL5,...\n2: 2.037385            0   79 GNLY,GZMB,FGFBP2,KLRD1,GZMH,SPON2,...\n3: 1.939876            0   84   GNLY,NKG7,GZMB,GZMA,CD247,KLRD1,...\n```\n:::\n:::\n\n\n#CT_GSEA8:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew.cluster.ids <- unlist(lapply(res, function(x) {\n    as.data.frame(x)[1, 1]\n}))\nalldata@colData$cellmarker_gsea <- new.cluster.ids[as.character(alldata@colData$louvain_SNNk15)]\n\ncowplot::plot_grid(\n    ncol = 2,\n    plotReducedDim(alldata, dimred = \"UMAP\", colour_by = \"cellmarker_gsea\"),\n    plotReducedDim(alldata, dimred = \"UMAP\", colour_by = \"ref_gsea\")\n)\n```\n\n::: {.cell-output-display}\n![](bioc_06_celltyping_files/figure-html/unnamed-chunk-36-1.png){width=960}\n:::\n:::\n\n\n:::{.callout-note title=\"Discuss\"}\n\n{{< meta ct_gsea_annot_2 >}}\n\n\n:::\n\n\n{{< meta ct_gsea_annot_3 >}}\n\n\n{{< meta ct_save >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(ctrl.sce,\"data/results/ctrl13_qc_dr_int_cl_celltype.rds\")\n```\n:::\n\n\n## {{< meta session >}}\n\n<details>\n  <summary>Click here</summary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Etc/UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] fgsea_1.28.0                caret_6.0-94               \n [3] lattice_0.21-8              SeuratObject_4.1.3         \n [5] Seurat_4.3.0                scmap_1.24.0               \n [7] scPred_1.9.2                rafalib_1.0.0              \n [9] pheatmap_1.0.12             cowplot_1.1.1              \n[11] dplyr_1.1.2                 scran_1.30.0               \n[13] scater_1.30.1               ggplot2_3.4.2              \n[15] scuttle_1.12.0              SingleCellExperiment_1.24.0\n[17] SummarizedExperiment_1.32.0 Biobase_2.62.0             \n[19] GenomicRanges_1.54.1        GenomeInfoDb_1.38.2        \n[21] IRanges_2.36.0              S4Vectors_0.40.2           \n[23] BiocGenerics_0.48.1         MatrixGenerics_1.14.0      \n[25] matrixStats_1.0.0          \n\nloaded via a namespace (and not attached):\n  [1] spatstat.sparse_3.0-1     bitops_1.0-7             \n  [3] lubridate_1.9.2           httr_1.4.6               \n  [5] RColorBrewer_1.1-3        tools_4.3.0              \n  [7] sctransform_0.3.5         utf8_1.2.3               \n  [9] R6_2.5.1                  lazyeval_0.2.2           \n [11] uwot_0.1.14               withr_2.5.0              \n [13] sp_1.6-1                  gridExtra_2.3            \n [15] progressr_0.13.0          cli_3.6.1                \n [17] spatstat.explore_3.2-1    labeling_0.4.2           \n [19] spatstat.data_3.0-1       randomForest_4.7-1.1     \n [21] proxy_0.4-27              ggridges_0.5.4           \n [23] pbapply_1.7-0             harmony_1.2.0            \n [25] parallelly_1.36.0         limma_3.58.1             \n [27] rstudioapi_0.14           FNN_1.1.3.2              \n [29] generics_0.1.3            ica_1.0-3                \n [31] spatstat.random_3.1-5     Matrix_1.5-4             \n [33] ggbeeswarm_0.7.2          fansi_1.0.4              \n [35] abind_1.4-5               lifecycle_1.0.3          \n [37] yaml_2.3.7                edgeR_4.0.3              \n [39] recipes_1.0.6             SparseArray_1.2.3        \n [41] Rtsne_0.16                grid_4.3.0               \n [43] promises_1.2.0.1          dqrng_0.3.0              \n [45] crayon_1.5.2              miniUI_0.1.1.1           \n [47] beachmat_2.18.0           pillar_1.9.0             \n [49] knitr_1.43                metapod_1.10.1           \n [51] future.apply_1.11.0       codetools_0.2-19         \n [53] fastmatch_1.1-3           leiden_0.4.3             \n [55] googleVis_0.7.1           glue_1.6.2               \n [57] data.table_1.14.8         vctrs_0.6.2              \n [59] png_0.1-8                 gtable_0.3.3             \n [61] kernlab_0.9-32            gower_1.0.1              \n [63] xfun_0.39                 S4Arrays_1.2.0           \n [65] mime_0.12                 prodlim_2023.03.31       \n [67] survival_3.5-5            timeDate_4022.108        \n [69] iterators_1.0.14          hardhat_1.3.0            \n [71] lava_1.7.2.1              statmod_1.5.0            \n [73] bluster_1.12.0            ellipsis_0.3.2           \n [75] fitdistrplus_1.1-11       ROCR_1.0-11              \n [77] ipred_0.9-14              nlme_3.1-162             \n [79] RcppAnnoy_0.0.20          irlba_2.3.5.1            \n [81] vipor_0.4.5               KernSmooth_2.23-20       \n [83] rpart_4.1.19              colorspace_2.1-0         \n [85] nnet_7.3-18               tidyselect_1.2.0         \n [87] compiler_4.3.0            BiocNeighbors_1.20.1     \n [89] DelayedArray_0.28.0       plotly_4.10.2            \n [91] scales_1.2.1              lmtest_0.9-40            \n [93] stringr_1.5.0             digest_0.6.31            \n [95] goftest_1.2-3             spatstat.utils_3.0-3     \n [97] rmarkdown_2.22            RhpcBLASctl_0.23-42      \n [99] XVector_0.42.0            htmltools_0.5.5          \n[101] pkgconfig_2.0.3           sparseMatrixStats_1.14.0 \n[103] fastmap_1.1.1             rlang_1.1.1              \n[105] htmlwidgets_1.6.2         shiny_1.7.4              \n[107] DelayedMatrixStats_1.24.0 farver_2.1.1             \n[109] zoo_1.8-12                jsonlite_1.8.5           \n[111] BiocParallel_1.36.0       ModelMetrics_1.2.2.2     \n[113] BiocSingular_1.18.0       RCurl_1.98-1.12          \n[115] magrittr_2.0.3            GenomeInfoDbData_1.2.11  \n[117] patchwork_1.1.2           munsell_0.5.0            \n[119] Rcpp_1.0.10               viridis_0.6.3            \n[121] reticulate_1.30           stringi_1.7.12           \n[123] pROC_1.18.2               zlibbioc_1.48.0          \n[125] MASS_7.3-58.4             plyr_1.8.8               \n[127] parallel_4.3.0            listenv_0.9.0            \n[129] ggrepel_0.9.3             deldir_1.0-9             \n[131] splines_4.3.0             tensor_1.5               \n[133] locfit_1.5-9.8            igraph_1.4.3             \n[135] spatstat.geom_3.2-1       reshape2_1.4.4           \n[137] ScaledMatrix_1.10.0       evaluate_0.21            \n[139] foreach_1.5.2             httpuv_1.6.11            \n[141] RANN_2.6.1                tidyr_1.3.0              \n[143] purrr_1.0.1               polyclip_1.10-4          \n[145] future_1.32.0             scattermore_1.2          \n[147] rsvd_1.0.5                xtable_1.8-4             \n[149] e1071_1.7-13              later_1.3.1              \n[151] viridisLite_0.4.2         class_7.3-21             \n[153] tibble_3.2.1              beeswarm_0.4.0           \n[155] cluster_2.1.4             timechange_0.2.0         \n[157] globals_0.16.2           \n```\n:::\n:::\n\n\n</details>\n",
    "supporting": [
      "bioc_06_celltyping_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}