{
  "hash": "6bb97866e12a274da2d74772f779f611",
  "result": {
    "markdown": "---\ntitle: \"{{< meta ct_title >}}\"\nsubtitle: \"{{< meta subtitle_seurat >}}\"\ndescription: \"{{< meta ct_description >}}\"\nformat: html\n---\n\n\n::: {.callout-note}\nCode chunks run R commands unless otherwise specified.\n:::\n\n\n{{< meta ct_1 >}}\n\n\n{{< meta ct_2 >}}\n\n\n\n## {{< meta ct_read >}}\n\n\n{{< meta ct_read_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages({\n    library(Seurat)\n    library(dplyr)\n    library(patchwork)\n    library(ggplot2)\n    library(pheatmap)\n    # remotes::install_github(\"powellgenomicslab/scPred\")\n    library(scPred)\n})\n```\n:::\n\n{{< meta ct_read_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath_data <- \"https://export.uppmax.uu.se/naiss2023-23-3/workshops/workshop-scrnaseq\"\npath_file <- \"data/covid/results/seurat_covid_qc_dr_int_cl.rds\"\nif (!file.exists(path_file)) download.file(url = file.path(path_data, \"covid/results/seurat_covid_qc_dr_int_cl.rds\"), destfile = path_file)\nalldata <- readRDS(path_file)\n```\n:::\n\n{{< meta ct_read_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl <- alldata[, alldata$orig.ident == \"ctrl_13\"]\n\n# set active assay to RNA and remove the CCA assay\nctrl@active.assay <- \"RNA\"\nctrl[[\"CCA\"]] <- NULL\nctrl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n18851 features across 1126 samples within 1 assay \nActive assay: RNA (18851 features, 2000 variable features)\n 6 dimensional reductions calculated: umap, tsne, umap_raw, pca_harmony, harmony, umap_harmony\n```\n:::\n:::\n\n\n## {{< meta ct_ref >}}\n\n\n{{< meta ct_ref_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreference <- scPred::pbmc_1\nreference\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n32838 features across 3500 samples within 1 assay \nActive assay: RNA (32838 features, 0 variable features)\n```\n:::\n:::\n\n{{< meta ct_ref_2 >}}\n\n\n\nHere, we will run all the steps that we did in previous labs in one go using the `magittr` package with the pipe-operator `%>%`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreference <- reference %>%\n    NormalizeData() %>%\n    FindVariableFeatures() %>%\n    ScaleData() %>%\n    RunPCA(verbose = F) %>%\n    RunUMAP(dims = 1:30)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(reference, group.by = \"cell_type\", label = TRUE, repel = TRUE) + NoAxes()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n{{< meta ct_ref_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the identity as louvain with resolution 0.3\nctrl <- SetIdent(ctrl, value = \"CCA_snn_res.0.5\")\n\nctrl <- ctrl %>%\n    NormalizeData() %>%\n    FindVariableFeatures() %>%\n    ScaleData() %>%\n    RunPCA(verbose = F) %>%\n    RunUMAP(dims = 1:30)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(ctrl, label = TRUE, repel = TRUE) + NoAxes()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-8-1.png){width=576}\n:::\n:::\n\n\n## Label transfer\n\nFirst we will run label transfer using a similar method as in the integration exercise. But, instad of CCA the default for the 'FindTransferAnchors` function is to use \"pcaproject\", e.g. the query dataset is projected onto the PCA of the reference dataset. Then, the labels of the reference data are predicted.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntransfer.anchors <- FindTransferAnchors(\n    reference = reference, query = ctrl,\n    dims = 1:30\n)\npredictions <- TransferData(\n    anchorset = transfer.anchors, refdata = reference$cell_type,\n    dims = 1:30\n)\nctrl <- AddMetaData(object = ctrl, metadata = predictions)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(ctrl, group.by = \"predicted.id\", label = T, repel = T) + NoAxes()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n\n\nNow plot how many cells of each celltypes can be found in each cluster.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ctrl@meta.data, aes(x = CCA_snn_res.0.5, fill = predicted.id)) +\n    geom_bar() +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\n## {{< meta ct_scpred >}}\n\n\n{{< meta ct_scpred_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreference <- getFeatureSpace(reference, \"cell_type\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Extracting feature space for each cell type...\nDONE!\n```\n:::\n\n```{.r .cell-code}\nreference <- trainModel(reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Training models for each cell type...\nmaximum number of iterations reached 0.0001152056 -0.0001143117DONE!\n```\n:::\n:::\n\n{{< meta ct_scpred_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_scpred(reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'scPred' object\n✔  Prediction variable = cell_type \n✔  Discriminant features per cell type\n✔  Training model(s)\nSummary\n\n|Cell type   |    n| Features|Method    |   ROC|  Sens|  Spec|\n|:-----------|----:|--------:|:---------|-----:|-----:|-----:|\n|B cell      |  280|       50|svmRadial | 1.000| 0.964| 1.000|\n|CD4 T cell  | 1620|       50|svmRadial | 0.997| 0.972| 0.975|\n|CD8 T cell  |  945|       50|svmRadial | 0.985| 0.899| 0.978|\n|cDC         |   26|       50|svmRadial | 0.995| 0.547| 1.000|\n|cMono       |  212|       50|svmRadial | 0.994| 0.958| 0.970|\n|ncMono      |   79|       50|svmRadial | 0.998| 0.570| 1.000|\n|NK cell     |  312|       50|svmRadial | 0.999| 0.933| 0.996|\n|pDC         |   20|       50|svmRadial | 1.000| 0.700| 1.000|\n|Plasma cell |    6|       50|svmRadial | 1.000| 0.800| 1.000|\n```\n:::\n:::\n\n{{< meta ct_scpred_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl <- scPredict(ctrl, reference)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n●  Matching reference with new dataset...\n\t ─ 2000 features present in reference loadings\n\t ─ 1782 features shared between reference and new dataset\n\t ─ 89.1% of features in the reference are present in new dataset\n●  Aligning new data to reference...\n●  Classifying cells...\nDONE!\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDimPlot(ctrl, group.by = \"scpred_prediction\", label = T, repel = T) + NoAxes()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-15-1.png){width=576}\n:::\n:::\n\n{{< meta ct_scpred_4 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ctrl@meta.data, aes(x = CCA_snn_res.0.5, fill = scpred_prediction)) +\n    geom_bar() +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n\n## {{< meta ct_compare >}}\n\n\n{{< meta ct_compare_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrossTab(ctrl, \"predicted.id\", \"scpred_prediction\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"B cell\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"CD4 T cell\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"CD8 T cell\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cDC\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"cMono\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"ncMono\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"NK cell\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"101\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0\",\"7\":\"0\",\"_rn_\":\"B cell\"},{\"1\":\"0\",\"2\":\"185\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"_rn_\":\"CD4 T cell\"},{\"1\":\"0\",\"2\":\"11\",\"3\":\"236\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"32\",\"_rn_\":\"CD8 T cell\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"2\",\"5\":\"11\",\"6\":\"0\",\"7\":\"0\",\"_rn_\":\"cDC\"},{\"1\":\"0\",\"2\":\"5\",\"3\":\"2\",\"4\":\"0\",\"5\":\"213\",\"6\":\"7\",\"7\":\"2\",\"_rn_\":\"cMono\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"3\",\"6\":\"118\",\"7\":\"0\",\"_rn_\":\"ncMono\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"2\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"153\",\"_rn_\":\"NK cell\"},{\"1\":\"0\",\"2\":\"3\",\"3\":\"7\",\"4\":\"0\",\"5\":\"28\",\"6\":\"1\",\"7\":\"3\",\"_rn_\":\"unassigned\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## {{< meta ct_gsea >}}\n\n\n{{< meta ct_gsea_1 >}}\n\n\n\n### {{< meta ct_gsea_deg >}}\n\n\n{{< meta ct_gsea_deg_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run differential expression in our dataset, using clustering at resolution 0.5\nalldata <- SetIdent(alldata, value = \"CCA_snn_res.0.5\")\nDGE_table <- FindAllMarkers(\n    alldata,\n    logfc.threshold = 0,\n    test.use = \"wilcox\",\n    min.pct = 0.1,\n    min.diff.pct = 0,\n    only.pos = TRUE,\n    max.cells.per.ident = 20,\n    return.thresh = 1,\n    assay = \"RNA\"\n)\n\n# split into a list\nDGE_list <- split(DGE_table, DGE_table$cluster)\n\nunlist(lapply(DGE_list, nrow))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   0    1    2    3    4    5    6    7    8 \n3349 4118 3271 2504 2061 2581 2426 3487 2355 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute differential gene expression in reference dataset (that has cell annotation)\nreference <- SetIdent(reference, value = \"cell_type\")\nreference_markers <- FindAllMarkers(\n    reference,\n    min.pct = .1,\n    min.diff.pct = .2,\n    only.pos = T,\n    max.cells.per.ident = 20,\n    return.thresh = 1\n)\n\n# Identify the top cell marker genes in reference dataset\n# select top 50 with hihgest foldchange among top 100 signifcant genes.\nreference_markers <- reference_markers[order(reference_markers$avg_log2FC, decreasing = T), ]\nreference_markers %>%\n    group_by(cluster) %>%\n    top_n(-100, p_val) %>%\n    top_n(50, avg_log2FC) -> top50_cell_selection\n\n# Transform the markers into a list\nref_list <- split(top50_cell_selection$gene, top50_cell_selection$cluster)\n\nunlist(lapply(ref_list, length))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n CD8 T cell  CD4 T cell       cMono      B cell     NK cell         pDC \n         30          15          50          50          50          50 \n     ncMono         cDC Plasma cell \n         50          50          50 \n```\n:::\n:::\n\n{{< meta ct_gsea_deg_2 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(fgsea))\n\n# run fgsea for each of the clusters in the list\nres <- lapply(DGE_list, function(x) {\n    gene_rank <- setNames(x$avg_log2FC, x$gene)\n    fgseaRes <- fgsea(pathways = ref_list, stats = gene_rank, nperm = 10000)\n    return(fgseaRes)\n})\nnames(res) <- names(DGE_list)\n\n# You can filter and resort the table based on ES, NES or pvalue\nres <- lapply(res, function(x) {\n    x[x$pval < 0.1, ]\n})\nres <- lapply(res, function(x) {\n    x[x$size > 2, ]\n})\nres <- lapply(res, function(x) {\n    x[order(x$NES, decreasing = T), ]\n})\nres\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`0`\n   pathway       pval        padj        ES      NES nMoreExtreme size\n1:   cMono 0.00009999 0.000299970 0.9594422 2.067666            0   48\n2:  ncMono 0.00009999 0.000299970 0.8385199 1.797428            0   43\n3:     cDC 0.00009999 0.000299970 0.8394045 1.795307            0   41\n4:     pDC 0.00180415 0.004059336 0.7492218 1.535717           17   21\n5: NK cell 0.02711970 0.048815461 0.7545862 1.436992          260   10\n6:  B cell 0.06447382 0.096710725 0.6666689 1.329777          638   15\n                                    leadingEdge\n1:      S100A8,S100A9,LYZ,S100A12,VCAN,FCN1,...\n2:     CTSS,TYMP,CST3,S100A11,AIF1,SERPINA1,...\n3:            LYZ,GRN,TYMP,CST3,AIF1,LGALS2,...\n4:         GRN,MS4A6A,CST3,MPEG1,CTSB,TGFBI,...\n5:      TYROBP,FCER1G,SRGN,CCL3,MYO1F,ITGB2,...\n6: NCF1,LY86,MARCH1,POU2F2,HLA-DMB,HLA-DRB5,...\n\n$`1`\n       pathway         pval         padj        ES      NES nMoreExtreme size\n1:     NK cell 0.0000999900 0.0004007213 0.9459800 2.369826            0   48\n2:  CD8 T cell 0.0001001803 0.0004007213 0.9230826 2.201075            0   25\n3:      ncMono 0.0008014655 0.0016029311 0.9101411 1.755775            6    6\n4:         pDC 0.0078939059 0.0126302494 0.7711439 1.640731           74   10\n5: Plasma cell 0.0007002101 0.0016029311 0.6711407 1.625909            6   30\n                                     leadingEdge\n1:          GNLY,GZMB,FGFBP2,PRF1,NKG7,SPON2,...\n2:           GNLY,GZMB,FGFBP2,PRF1,NKG7,CTSW,...\n3:                            FCGR3A,IFITM2,RHOC\n4: GZMB,C12orf75,HSP90B1,ALOX5AP,PLAC8,RRBP1,...\n5:      FKBP11,CD38,SDF2L1,PRDM1,PPIB,SLAMF7,...\n\n$`2`\n       pathway         pval         padj        ES      NES nMoreExtreme size\n1:  CD8 T cell 0.0001001101 0.0003503854 0.9406368 2.161149            0   29\n2:     NK cell 0.0001000500 0.0003503854 0.8208967 1.898566            0   32\n3:  CD4 T cell 0.0014347202 0.0033476805 0.8706473 1.681457           12    7\n4: Plasma cell 0.0744595677 0.1042433947 0.5638039 1.298014          743   30\n                               leadingEdge\n1:       CD3D,CD8A,CD3G,CCL5,CD8B,GZMH,...\n2:       CCL5,GZMA,CCL4,NKG7,GZMM,CST7,...\n3:        CD3D,CD3G,CD3E,IL7R,PIK3IP1,TCF7\n4: FKBP11,PRDM1,PEBP1,PPIB,SEC11C,SUB1,...\n\n$`3`\n       pathway         pval         padj        ES      NES nMoreExtreme size\n1:      B cell 0.0000999900 0.0002706726 0.9072478 1.989836            0   46\n2:         cDC 0.0001015022 0.0002706726 0.8950426 1.806256            0   14\n3:         pDC 0.0001008878 0.0002706726 0.8292186 1.700818            0   17\n4: Plasma cell 0.0348925962 0.0558281540 0.7900880 1.456388          319    7\n                                            leadingEdge\n1:      CD79A,LINC00926,TCL1A,MS4A1,TNFRSF13C,CD79B,...\n2: CD74,HLA-DQB1,HLA-DRA,HLA-DPB1,HLA-DRB1,HLA-DQA1,...\n3:            CD74,BCL11A,TCF4,IRF8,HERPUD1,TSPAN13,...\n4:                       PLPP5,ISG20,HERPUD1,MZB1,ITM2C\n\n$`4`\n      pathway         pval         padj        ES      NES nMoreExtreme size\n1: CD4 T cell 0.0001015744 0.0003199659 0.9121965 1.771474            0   14\n2: CD8 T cell 0.0001066553 0.0003199659 0.9014219 1.638647            0    8\n                         leadingEdge\n1: IL7R,LTB,LDHB,MAL,RCAN3,NOSIP,...\n2:      CD3D,IL32,CD3G,CD2,CD3E,CD8B\n\n$`5`\n   pathway       pval      padj        ES      NES nMoreExtreme size\n1:  B cell 0.07818977 0.2503001 0.8293407 1.392212          678    5\n2:     pDC 0.04285714 0.2503001 0.7176562 1.385862          425   18\n3:  ncMono 0.08343337 0.2503001 0.6474875 1.279034          833   28\n                              leadingEdge\n1:                   PDLIM1,HLA-DRB5,STX7\n2:   PTCRA,TXN,C12orf75,CST3,CTSB,APP,...\n3: OAZ1,TIMP1,IFITM3,FKBP1A,CD68,CST3,...\n\n$`6`\n       pathway         pval         padj        ES      NES nMoreExtreme size\n1:      B cell 0.0000999900 0.0005417852 0.8919905 1.838712            0   45\n2:         cDC 0.0002031694 0.0005417852 0.8894057 1.705469            1   14\n3:         pDC 0.0002015316 0.0005417852 0.8313241 1.622237            1   17\n4: Plasma cell 0.0232629013 0.0281224853 0.7396460 1.418299          228   14\n                                            leadingEdge\n1:        CD79A,MS4A1,BANK1,HLA-DQA1,CD74,TNFRSF13C,...\n2: HLA-DQA1,CD74,HLA-DRA,HLA-DPB1,HLA-DQB1,HLA-DPA1,...\n3:             CD74,JCHAIN,SPIB,TCF4,CCDC50,HERPUD1,...\n4:                JCHAIN,HERPUD1,ISG20,PEBP1,MZB1,ITM2C\n\n$`7`\n   pathway       pval         padj        ES      NES nMoreExtreme size\n1:  ncMono 0.00009999 0.0002666667 0.9644737 2.033813            0   49\n2:   cMono 0.00010000 0.0002666667 0.8854337 1.838288            0   36\n3:     cDC 0.00009999 0.0002666667 0.8309648 1.730082            0   38\n4: NK cell 0.01025485 0.0205096964 0.7621593 1.478759          100   14\n5:     pDC 0.02631313 0.0421010019 0.7165790 1.398343          259   15\n6:  B cell 0.05732420 0.0764322654 0.6694322 1.321810          568   17\n                                              leadingEdge\n1:                CDKN1C,LST1,FCGR3A,MS4A7,AIF1,COTL1,...\n2:               LST1,AIF1,COTL1,SERPINA1,FCER1G,CST3,...\n3:                   LST1,AIF1,COTL1,FCER1G,CST3,SPI1,...\n4:              FCGR3A,FCER1G,RHOC,TYROBP,IFITM2,CCL3,...\n5:                    CST3,NPC2,CTSB,PLD4,MPEG1,TGFBI,...\n6: HLA-DPA1,POU2F2,HLA-DRB5,HLA-DRB1,HLA-DRA,HLA-DPB1,...\n\n$`8`\n      pathway         pval         padj        ES      NES nMoreExtreme size\n1: CD4 T cell 0.0001015744 0.0006094464 0.9413572 2.012718            0   14\n2: CD8 T cell 0.0234593838 0.0703781513 0.8283043 1.494351          200    5\n                            leadingEdge\n1: IL7R,TCF7,PIK3IP1,LTB,LEF1,TSHZ2,...\n2:                   CD3G,CD3D,CD3E,CD2\n```\n:::\n:::\n\n{{< meta ct_gsea_deg_3 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew.cluster.ids <- unlist(lapply(res, function(x) {\n    as.data.frame(x)[1, 1]\n}))\n\nalldata$ref_gsea <- new.cluster.ids[as.character(alldata@active.ident)]\n\nwrap_plots(\n    DimPlot(alldata, label = T, group.by = \"CCA_snn_res.0.5\") + NoAxes(),\n    DimPlot(alldata, label = T, group.by = \"ref_gsea\") + NoAxes(),\n    ncol = 2\n)\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n{{< meta ct_gsea_deg_4 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nctrl$ref_gsea <- alldata$ref_gsea[alldata$orig.ident == \"ctrl_13\"]\n\nwrap_plots(\n    DimPlot(ctrl, label = T, group.by = \"ref_gsea\") + NoAxes() + ggtitle(\"GSEA\"),\n    DimPlot(ctrl, label = T, group.by = \"predicted.id\") + NoAxes() + ggtitle(\"LabelTransfer\"),\n    DimPlot(ctrl, label = T, group.by = \"scpred_prediction\") + NoAxes() + ggtitle(\"scPred\"),\n    ncol = 3\n)\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-22-1.png){width=1536}\n:::\n:::\n\n\n### {{< meta ct_gsea_annot >}}\n\n\n{{< meta ct_gsea_annot_1 >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath_file <- file.path(\"data/cell_marker_human.csv\")\nif (!file.exists(path_file)) download.file(file.path(path_data, \"cell_marker_human.csv\"), destfile = path_file)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the human marker table\nmarkers <- read.delim(\"data/cell_marker_human.csv\", sep = \";\")\nmarkers <- markers[markers$species == \"Human\", ]\nmarkers <- markers[markers$cancer_type == \"Normal\", ]\n\n# Filter by tissue (to reduce computational time and have tissue-specific classification)\nsort(unique(markers$tissue_type))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"Abdomen\"                        \"Abdominal adipose tissue\"      \n  [3] \"Abdominal fat pad\"              \"Acinus\"                        \n  [5] \"Adipose tissue\"                 \"Adrenal gland\"                 \n  [7] \"Adventitia\"                     \"Airway\"                        \n  [9] \"Airway epithelium\"              \"Allocortex\"                    \n [11] \"Alveolus\"                       \"Amniotic fluid\"                \n [13] \"Amniotic membrane\"              \"Ampullary\"                     \n [15] \"Anogenital tract\"               \"Antecubital vein\"              \n [17] \"Anterior cruciate ligament\"     \"Anterior presomitic mesoderm\"  \n [19] \"Aorta\"                          \"Aortic valve\"                  \n [21] \"Artery\"                         \"Arthrosis\"                     \n [23] \"Articular Cartilage\"            \"Ascites\"                       \n [25] \"Atrium\"                         \"Auditory cortex\"               \n [27] \"Basilar membrane\"               \"Beige Fat\"                     \n [29] \"Bile duct\"                      \"Biliary tract\"                 \n [31] \"Bladder\"                        \"Blood\"                         \n [33] \"Blood vessel\"                   \"Bone\"                          \n [35] \"Bone marrow\"                    \"Brain\"                         \n [37] \"Breast\"                         \"Bronchial vessel\"              \n [39] \"Bronchiole\"                     \"Bronchoalveolar lavage\"        \n [41] \"Bronchoalveolar system\"         \"Bronchus\"                      \n [43] \"Brown adipose tissue\"           \"Calvaria\"                      \n [45] \"Capillary\"                      \"Cardiac atrium\"                \n [47] \"Cardiovascular system\"          \"Carotid artery\"                \n [49] \"Carotid plaque\"                 \"Cartilage\"                     \n [51] \"Caudal cortex\"                  \"Caudal forebrain\"              \n [53] \"Caudal ganglionic eminence\"     \"Cavernosum\"                    \n [55] \"Central amygdala\"               \"Central nervous system\"        \n [57] \"Central Nervous System\"         \"Cerebellum\"                    \n [59] \"Cerebral organoid\"              \"Cerebrospinal fluid\"           \n [61] \"Choriocapillaris\"               \"Chorionic villi\"               \n [63] \"Chorionic villus\"               \"Choroid\"                       \n [65] \"Choroid plexus\"                 \"Colon\"                         \n [67] \"Colon epithelium\"               \"Colorectum\"                    \n [69] \"Cornea\"                         \"Corneal endothelium\"           \n [71] \"Corneal epithelium\"             \"Coronary artery\"               \n [73] \"Corpus callosum\"                \"Corpus luteum\"                 \n [75] \"Cortex\"                         \"Cortical layer\"                \n [77] \"Cortical thymus\"                \"Decidua\"                       \n [79] \"Deciduous tooth\"                \"Dental pulp\"                   \n [81] \"Dermis\"                         \"Diencephalon\"                  \n [83] \"Distal airway\"                  \"Dorsal forebrain\"              \n [85] \"Dorsal root ganglion\"           \"Dorsolateral prefrontal cortex\"\n [87] \"Ductal tissue\"                  \"Duodenum\"                      \n [89] \"Ectocervix\"                     \"Ectoderm\"                      \n [91] \"Embryo\"                         \"Embryoid body\"                 \n [93] \"Embryonic brain\"                \"Embryonic heart\"               \n [95] \"Embryonic Kidney\"               \"Embryonic prefrontal cortex\"   \n [97] \"Embryonic stem cell\"            \"Endocardium\"                   \n [99] \"Endocrine\"                      \"Endoderm\"                      \n[101] \"Endometrium\"                    \"Endometrium stroma\"            \n[103] \"Entorhinal cortex\"              \"Epidermis\"                     \n[105] \"Epithelium\"                     \"Esophagus\"                     \n[107] \"Eye\"                            \"Fat pad\"                       \n[109] \"Fetal brain\"                    \"Fetal gonad\"                   \n[111] \"Fetal heart\"                    \"Fetal ileums\"                  \n[113] \"Fetal kidney\"                   \"Fetal Leydig\"                  \n[115] \"Fetal liver\"                    \"Fetal lung\"                    \n[117] \"Fetal pancreas\"                 \"Fetal thymus\"                  \n[119] \"Fetal umbilical cord\"           \"Fetus\"                         \n[121] \"Foreskin\"                       \"Frontal cortex\"                \n[123] \"Fundic gland\"                   \"Gall bladder\"                  \n[125] \"Gastric corpus\"                 \"Gastric epithelium\"            \n[127] \"Gastric gland\"                  \"Gastrointestinal tract\"        \n[129] \"Germ\"                           \"Gingiva\"                       \n[131] \"Gonad\"                          \"Gut\"                           \n[133] \"Hair follicle\"                  \"Heart\"                         \n[135] \"Heart muscle\"                   \"Hippocampus\"                   \n[137] \"Ileum\"                          \"Inferior colliculus\"           \n[139] \"Interfollicular epidermis\"      \"Intervertebral disc\"           \n[141] \"Intestinal crypt\"               \"Intestine\"                     \n[143] \"Intrahepatic cholangio\"         \"Jejunum\"                       \n[145] \"Kidney\"                         \"Lacrimal gland\"                \n[147] \"Large intestine\"                \"Laryngeal squamous epithelium\" \n[149] \"Lateral ganglionic eminence\"    \"Ligament\"                      \n[151] \"Limb bud\"                       \"Limbal epithelium\"             \n[153] \"Liver\"                          \"Lumbar vertebra\"               \n[155] \"Lung\"                           \"Lymph\"                         \n[157] \"Lymph node\"                     \"Lymphatic vessel\"              \n[159] \"Lymphoid tissue\"                \"Malignant pleural effusion\"    \n[161] \"Mammary epithelium\"             \"Mammary gland\"                 \n[163] \"Medial ganglionic eminence\"     \"Medullary thymus\"              \n[165] \"Meniscus\"                       \"Mesoblast\"                     \n[167] \"Mesoderm\"                       \"Microvascular endothelium\"     \n[169] \"Microvessel\"                    \"Midbrain\"                      \n[171] \"Middle temporal gyrus\"          \"Milk\"                          \n[173] \"Molar\"                          \"Muscle\"                        \n[175] \"Myenteric plexus\"               \"Myocardium\"                    \n[177] \"Myometrium\"                     \"Nasal concha\"                  \n[179] \"Nasal epithelium\"               \"Nasal mucosa\"                  \n[181] \"Nasal polyp\"                    \"Neocortex\"                     \n[183] \"Nerve\"                          \"Nose\"                          \n[185] \"Nucleus pulposus\"               \"Olfactory neuroepithelium\"     \n[187] \"Optic nerve\"                    \"Oral cavity\"                   \n[189] \"Oral mucosa\"                    \"Osteoarthritic cartilage\"      \n[191] \"Ovarian cortex\"                 \"Ovarian follicle\"              \n[193] \"Ovary\"                          \"Oviduct\"                       \n[195] \"Pancreas\"                       \"Pancreatic acinar tissue\"      \n[197] \"Pancreatic duct\"                \"Pancreatic islet\"              \n[199] \"Periodontal ligament\"           \"Periodontium\"                  \n[201] \"Periosteum\"                     \"Peripheral blood\"              \n[203] \"Peritoneal fluid\"               \"Peritoneum\"                    \n[205] \"Pituitary\"                      \"Placenta\"                      \n[207] \"Plasma\"                         \"Pluripotent stem cell\"         \n[209] \"Polyp\"                          \"Posterior presomitic mesoderm\" \n[211] \"Prefrontal cortex\"              \"Premolar\"                      \n[213] \"Presomitic mesoderm\"            \"Primitive streak\"              \n[215] \"Prostate\"                       \"Pulmonary arteriy\"             \n[217] \"Pyloric gland\"                  \"Rectum\"                        \n[219] \"Renal glomerulus\"               \"Respiratory tract\"             \n[221] \"Retina\"                         \"Retinal organoid\"              \n[223] \"Retinal pigment epithelium\"     \"Right ventricle\"               \n[225] \"Saliva\"                         \"Salivary gland\"                \n[227] \"Scalp\"                          \"Sclerocorneal tissue\"          \n[229] \"Seminal plasma\"                 \"Septum transversum\"            \n[231] \"Serum\"                          \"Sinonasal mucosa\"              \n[233] \"Sinus tissue\"                   \"Skeletal muscle\"               \n[235] \"Skin\"                           \"Small intestinal crypt\"        \n[237] \"Small intestine\"                \"Soft tissue\"                   \n[239] \"Sperm\"                          \"Spinal cord\"                   \n[241] \"Spleen\"                         \"Splenic red pulp\"              \n[243] \"Sputum\"                         \"Stomach\"                       \n[245] \"Subcutaneous adipose tissue\"    \"Submandibular gland\"           \n[247] \"Subpallium\"                     \"Subplate\"                      \n[249] \"Subventricular zone\"            \"Superior frontal gyrus\"        \n[251] \"Sympathetic ganglion\"           \"Synovial fluid\"                \n[253] \"Synovium\"                       \"Taste bud\"                     \n[255] \"Tendon\"                         \"Testis\"                        \n[257] \"Thalamus\"                       \"Thymus\"                        \n[259] \"Thyroid\"                        \"Tonsil\"                        \n[261] \"Tooth\"                          \"Trachea\"                       \n[263] \"Tracheal airway epithelium\"     \"Transformed artery\"            \n[265] \"Trophoblast\"                    \"Umbilical cord\"                \n[267] \"Umbilical cord blood\"           \"Umbilical vein\"                \n[269] \"Undefined\"                      \"Urine\"                         \n[271] \"Urothelium\"                     \"Uterine cervix\"                \n[273] \"Uterus\"                         \"Vagina\"                        \n[275] \"Vein\"                           \"Venous blood\"                  \n[277] \"Ventral thalamus\"               \"Ventricle\"                     \n[279] \"Ventricular and atrial\"         \"Ventricular zone\"              \n[281] \"Visceral adipose tissue\"        \"Vocal fold\"                    \n[283] \"Whartons jelly\"                 \"White adipose tissue\"          \n[285] \"White matter\"                   \"Yolk sac\"                      \n```\n:::\n\n```{.r .cell-code}\ngrep(\"blood\", unique(markers$tissue_type), value = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Peripheral blood\"     \"Umbilical cord blood\" \"Venous blood\"        \n```\n:::\n\n```{.r .cell-code}\nmarkers <- markers[markers$tissue_type %in% c(\n    \"Blood\", \"Venous blood\",\n    \"Serum\", \"Plasma\",\n    \"Spleen\", \"Bone marrow\", \"Lymph node\"\n), ]\n\n# remove strange characters etc.\ncelltype_list <- lapply(unique(markers$cell_name), function(x) {\n    x <- paste(markers$Symbol[markers$cell_name == x], sep = \",\")\n    x <- gsub(\"[[]|[]]| |-\", \",\", x)\n    x <- unlist(strsplit(x, split = \",\"))\n    x <- unique(x[!x %in% c(\"\", \"NA\", \"family\")])\n    x <- casefold(x, upper = T)\n})\nnames(celltype_list) <- unique(markers$cell_name)\n\ncelltype_list <- celltype_list[unlist(lapply(celltype_list, length)) < 100]\ncelltype_list <- celltype_list[unlist(lapply(celltype_list, length)) > 5]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# run fgsea for each of the clusters in the list\nres <- lapply(DGE_list, function(x) {\n    gene_rank <- setNames(x$avg_log2FC, x$gene)\n    fgseaRes <- fgsea(pathways = celltype_list, stats = gene_rank, nperm = 10000, scoreType = \"pos\")\n    return(fgseaRes)\n})\nnames(res) <- names(DGE_list)\n\n# You can filter and resort the table based on ES, NES or pvalue\nres <- lapply(res, function(x) {\n    x[x$pval < 0.01, ]\n})\nres <- lapply(res, function(x) {\n    x[x$size > 5, ]\n})\nres <- lapply(res, function(x) {\n    x[order(x$NES, decreasing = T), ]\n})\n\n# show top 3 for each cluster.\nlapply(res, head, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`0`\n      pathway      pval        padj        ES      NES nMoreExtreme size\n1: Neutrophil 9.999e-05 0.002274773 0.8596747 1.768180            0   22\n2:   Monocyte 9.999e-05 0.002274773 0.8152552 1.737522            0   40\n3: Eosinophil 9.999e-05 0.002274773 0.8683785 1.723714            0   13\n                                 leadingEdge\n1: S100A8,S100A9,CD14,CSF3R,S100A6,PLAUR,...\n2:   S100A8,S100A9,LYZ,S100A12,VCAN,FCN1,...\n3:    S100A8,S100A9,LYZ,RETN,CSF3R,ICAM1,...\n\n$`1`\n                                                            pathway      pval\n1:                                              Natural killer cell 9.999e-05\n2:                    Finally highly effector (TEMRA) memory T cell 9.999e-05\n3: CD4+ recently activated effector memory or effector T cell (CTL) 9.999e-05\n         padj        ES      NES nMoreExtreme size\n1: 0.00076356 0.9028054 2.222363            0   38\n2: 0.00076356 0.9919728 2.101706            0    7\n3: 0.00076356 0.9500974 2.081966            0   10\n                            leadingEdge\n1: GNLY,GZMB,FGFBP2,PRF1,NKG7,SPON2,...\n2:    GNLY,NKG7,CST7,GZMA,GZMH,CCL5,...\n3:   GNLY,PRF1,NKG7,CTSW,GZMH,S1PR5,...\n\n$`2`\n       pathway      pval       padj        ES      NES nMoreExtreme size\n1: CD8+ T cell 9.999e-05 0.00049995 0.9582694 2.068813            0   12\n2: CD4+ T cell 9.999e-05 0.00049995 0.9437698 2.022236            0   11\n3:      T cell 9.999e-05 0.00049995 0.8614252 2.005057            0   32\n                          leadingEdge\n1: CD3D,CD8A,CD8B,TRGC2,TRAC,CD3E,...\n2:  CD3D,CD8A,TRAC,CD3E,IL32,IL7R,...\n3:  GZMK,CD3D,CD8A,CD3G,CD8B,GZMH,...\n\n$`3`\n             pathway      pval        padj        ES      NES nMoreExtreme size\n1:            B cell 9.999e-05 0.001849815 0.9003237 1.923899            0   29\n2:      Naive B cell 9.999e-05 0.001849815 0.9502942 1.919618            0   13\n3: Follicular B cell 9.999e-05 0.001849815 0.9530874 1.889348            0   10\n                             leadingEdge\n1:  IGHM,IGHD,CD79A,IGKC,TCL1A,MS4A1,...\n2:  IGHM,IGHD,TCL1A,MS4A1,FCER2,YBX3,...\n3: IGHD,CD79A,TCL1A,MS4A1,CD79B,CD74,...\n\n$`4`\n             pathway       pval        padj        ES      NES nMoreExtreme\n1: Naive T(Th0) cell 0.00009999 0.004099590 0.9024674 1.739839            0\n2:       CD8+ T cell 0.00029997 0.006149385 0.8842482 1.716703            2\n3:            B cell 0.00029997 0.006149385 0.8703159 1.677856            2\n   size                       leadingEdge\n1:   11 IL7R,CD3D,IL32,TCF7,CD3E,NPM1,...\n2:   12 IL7R,TRAC,CD3D,IL32,CD28,CD3E,...\n3:   11  IL7R,CD5,CD28,JUNB,CD27,BCL2,...\n\n$`5`\n         pathway       pval       padj        ES      NES nMoreExtreme size\n1: Megakaryocyte 0.00009999 0.00649935 0.9892473 1.865505            0   11\n2:   Plasmablast 0.00209979 0.03412159 0.9327396 1.721114           20    6\n3: Memory B cell 0.00959904 0.11482185 0.8912334 1.644526           95    6\n                        leadingEdge\n1: PPBP,PF4,NRGN,MYL9,GNG11,GP9,...\n2:    IGHA1,IGLC2,TUBA1B,IGKC,GAPDH\n3:                      IGHA1,KLF10\n\n$`6`\n                pathway       pval        padj        ES      NES nMoreExtreme\n1:               B cell 0.00009999 0.002533080 0.8810749 1.800871            0\n2:          Plasma cell 0.00009999 0.002533080 0.9278632 1.783346            0\n3: Marginal zone B cell 0.00029997 0.004559544 0.9495868 1.747841            2\n   size                           leadingEdge\n1:   37  IGKC,CD79A,MS4A1,BANK1,IGHM,CD74,...\n2:   13 IGKC,CD79A,IGLC3,IGLC2,IGHM,IGHG1,...\n3:    6 CD79A,MS4A1,CD79B,TNFRSF13B,CD19,CD27\n\n$`7`\n          pathway       pval      padj        ES      NES nMoreExtreme size\n1: CD16+ monocyte 0.00029997 0.0089991 0.9435730 1.753112            2    6\n2:       Monocyte 0.00009999 0.0089991 0.8135685 1.662756            0   27\n3:     Macrophage 0.00019998 0.0089991 0.8087559 1.641009            1   24\n                              leadingEdge\n1:           FCGR3A,TCF7L2,HES4,LYN,MTSS1\n2: LST1,FCGR3A,MS4A7,CST3,PECAM1,CD68,...\n3:  FCGR3A,MS4A7,FCER1G,CD68,FTL,C1QA,...\n\n$`8`\n                      pathway      pval       padj        ES      NES\n1: Central memory CD8+ T cell 9.999e-05 0.00109989 0.9139722 1.941589\n2:          Naive CD8+ T cell 9.999e-05 0.00109989 0.8685820 1.893681\n3:           Naive CD8 T cell 9.999e-05 0.00109989 0.9024094 1.879507\n   nMoreExtreme size                         leadingEdge\n1:            0   12 CCR7,IL7R,TCF7,LEF1,TSHZ2,RCAN3,...\n2:            0   16  CCR7,TCF7,LEF1,TSHZ2,RCAN3,MAL,...\n3:            0   10  CCR7,TCF7,LEF1,TSHZ2,RCAN3,MAL,...\n```\n:::\n:::\n\n\n#CT_GSEA8:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew.cluster.ids <- unlist(lapply(res, function(x) {\n    as.data.frame(x)[1, 1]\n}))\nalldata$cellmarker_gsea <- new.cluster.ids[as.character(alldata@active.ident)]\n\nwrap_plots(\n    DimPlot(alldata, label = T, group.by = \"ref_gsea\") + NoAxes(),\n    DimPlot(alldata, label = T, group.by = \"cellmarker_gsea\") + NoAxes(),\n    ncol = 2\n)\n```\n\n::: {.cell-output-display}\n![](seurat_06_celltyping_files/figure-html/unnamed-chunk-26-1.png){width=1056}\n:::\n:::\n\n\n:::{.callout-note title=\"Discuss\"}\n\n{{< meta ct_gsea_annot_2 >}}\n\n\n:::\n\n\n{{< meta ct_gsea_annot_3 >}}\n\n\n{{< meta ct_save >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(ctrl, \"data/covid/results/seurat_covid_qc_dr_int_cl_ct-ctrl13.rds\")\n```\n:::\n\n\n## {{< meta session >}}\n\n<details>\n  <summary>Click here</summary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Etc/UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] fgsea_1.28.0       caret_6.0-94       lattice_0.21-8     scPred_1.9.2      \n [5] pheatmap_1.0.12    ggplot2_3.4.2      patchwork_1.1.2    dplyr_1.1.2       \n [9] SeuratObject_4.1.3 Seurat_4.3.0      \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.14        jsonlite_1.8.5        \n  [4] magrittr_2.0.3         ggbeeswarm_0.7.2       spatstat.utils_3.0-3  \n  [7] farver_2.1.1           rmarkdown_2.22         vctrs_0.6.2           \n [10] ROCR_1.0-11            spatstat.explore_3.2-1 htmltools_0.5.5       \n [13] pROC_1.18.2            sctransform_0.3.5      parallelly_1.36.0     \n [16] KernSmooth_2.23-20     htmlwidgets_1.6.2      ica_1.0-3             \n [19] plyr_1.8.8             lubridate_1.9.2        plotly_4.10.2         \n [22] zoo_1.8-12             igraph_1.4.3           mime_0.12             \n [25] lifecycle_1.0.3        iterators_1.0.14       pkgconfig_2.0.3       \n [28] Matrix_1.5-4           R6_2.5.1               fastmap_1.1.1         \n [31] fitdistrplus_1.1-11    future_1.32.0          shiny_1.7.4           \n [34] digest_0.6.31          colorspace_2.1-0       tensor_1.5            \n [37] irlba_2.3.5.1          labeling_0.4.2         progressr_0.13.0      \n [40] timechange_0.2.0       fansi_1.0.4            spatstat.sparse_3.0-1 \n [43] httr_1.4.6             polyclip_1.10-4        abind_1.4-5           \n [46] compiler_4.3.0         withr_2.5.0            BiocParallel_1.36.0   \n [49] lava_1.7.2.1           MASS_7.3-58.4          ModelMetrics_1.2.2.2  \n [52] tools_4.3.0            vipor_0.4.5            lmtest_0.9-40         \n [55] beeswarm_0.4.0         httpuv_1.6.11          future.apply_1.11.0   \n [58] nnet_7.3-18            goftest_1.2-3          glue_1.6.2            \n [61] nlme_3.1-162           promises_1.2.0.1       grid_4.3.0            \n [64] Rtsne_0.16             cluster_2.1.4          reshape2_1.4.4        \n [67] generics_0.1.3         recipes_1.0.6          gtable_0.3.3          \n [70] spatstat.data_3.0-1    class_7.3-21           tidyr_1.3.0           \n [73] data.table_1.14.8      sp_1.6-1               utf8_1.2.3            \n [76] spatstat.geom_3.2-1    RcppAnnoy_0.0.20       ggrepel_0.9.3         \n [79] RANN_2.6.1             foreach_1.5.2          pillar_1.9.0          \n [82] stringr_1.5.0          limma_3.58.1           later_1.3.1           \n [85] splines_4.3.0          survival_3.5-5         deldir_1.0-9          \n [88] tidyselect_1.2.0       miniUI_0.1.1.1         pbapply_1.7-0         \n [91] knitr_1.43             gridExtra_2.3          scattermore_1.2       \n [94] RhpcBLASctl_0.23-42    stats4_4.3.0           xfun_0.39             \n [97] statmod_1.5.0          hardhat_1.3.0          timeDate_4022.108     \n[100] matrixStats_1.0.0      stringi_1.7.12         lazyeval_0.2.2        \n[103] yaml_2.3.7             evaluate_0.21          codetools_0.2-19      \n[106] kernlab_0.9-32         tibble_3.2.1           cli_3.6.1             \n[109] uwot_0.1.14            rpart_4.1.19           xtable_1.8-4          \n[112] reticulate_1.30        munsell_0.5.0          harmony_1.2.0         \n[115] Rcpp_1.0.10            globals_0.16.2         spatstat.random_3.1-5 \n[118] png_0.1-8              parallel_4.3.0         ellipsis_0.3.2        \n[121] gower_1.0.1            listenv_0.9.0          viridisLite_0.4.2     \n[124] ipred_0.9-14           prodlim_2023.03.31     scales_1.2.1          \n[127] ggridges_0.5.4         crayon_1.5.2           leiden_0.4.3          \n[130] purrr_1.0.1            rlang_1.1.1            fastmatch_1.1-3       \n[133] cowplot_1.1.1         \n```\n:::\n:::\n\n\n</details>\n",
    "supporting": [
      "seurat_06_celltyping_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}